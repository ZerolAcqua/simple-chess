(()=>{"use strict";var e,r,t={668:(e,r,t)=>{var n,i=t(169);!function(e){e[e.Opening=0]="Opening",e[e.Middle=1]="Middle",e[e.Ending=2]="Ending"}(n||(n={}));let o=n.Opening,s=0,l=!1,a=3e4,c=50;function u(e,r=3,t){let i="w"===e.turn();s=0,l=t?.testTFR??!1,a=t?.maxSearchNum??3e4,c=t?.moveThreshold??50;let u=e.moves({verbose:!0});!function(e){if(e.moveNumber()<15)o=n.Opening;else if(e.moveNumber()>50)o=n.Ending;else{let r=e.board(),t=0;for(let e=0;e<8;e++)for(let n=0;n<8;++n){let i=r[e][n];if(null===i)continue;let o=d(i);"w"===i.color&&(t+=o)}o=t<1500?n.Ending:n.Middle}}(e);let m=u[0],v=i?-1/0:1/0;u=u.slice(0,c);let g=u.filter((e=>e.san.includes("#")));if(g.length>0)return g[0];for(const t of u){e.move(t);const n=f(e,r-1,-1/0,1/0,!i);e.undo(),p(n,v,i)&&(v=n,m=t)}return m}function p(e,r,t=!0){return t?e>r:e<r}function f(e,r,t,i,u){let p=e.moves();if(s++,s>a)return 0;if(0===p.length)return e.isCheck()?"w"===e.turn()?-2e4-r:2e4+r:0;if(l&&e.isThreefoldRepetition())return 0;if(0===r)return function(e){if(e.isInsufficientMaterial())return 0;let r=e.board(),t=0,i=0,s=0;for(let e=0;e<8;e++)for(let t=0;t<8;++t){let n=r[e][t];if(null===n)continue;let l=d(n)+m(n,e,t,o);"w"===n.color?i+=l:s+=l}switch(t=i+s,o){case n.Opening:break;case n.Middle:"w"===e.turn()&&t<-100?t+=.001*(i-s):"b"===e.turn()&&t>100&&(t+=.001*(s-i));break;case n.Ending:t+=10*function(e){let r=e.board(),t={i:-1,j:-1},n={i:-1,j:-1};for(let e=0;e<8;++e)for(let i=0;i<8;++i)"k"===r[e][i]?.type&&("w"===r[e][i]?.color?(t.i=e,t.j=i):(n.i=e,n.j=i));let i=0,o=0;for(let e=t.i-1;e<=t.i+1;++e)if(!(e<0||e>=8))for(let n=t.j-1;n<=t.j+1;++n)n<0||n>=8||"p"===r[e][n]?.type&&i++;for(let e=n.i-1;e<=n.i+1;++e)if(!(e<0||e>=8))for(let t=n.j-1;t<=n.j+1;++t)t<0||t>=8||"p"===r[e][t]?.type&&o++;return i-o}(e)}return t}(e);if(p=p.slice(0,c),u){let n=-1/0;for(const o of p)if(e.move(o),n=Math.max(n,f(e,r-1,t,i,!1)),e.undo(),i<=(t=Math.max(t,n)))return n;return n}{let n=1/0;for(const o of p)if(e.move(o),n=Math.min(n,f(e,r-1,t,i,!0)),e.undo(),(i=Math.min(i,n))<=t)return n;return n}}function d(e){if(null===e)return 0;let r=0;switch(e.type){case"p":r=100;break;case"b":r=330;break;case"n":r=320;break;case"r":r=500;break;case"q":r=900;break;case"k":r=0}return"w"===e.color?r:-r}function m(e,r,t,i=n.Opening){switch(i){case n.Opening:return null===e?0:w[e.color][e.type][r][t];case n.Middle:return null===e?0:k[e.color][e.type][r][t];case n.Ending:return null===e?0:y[e.color][e.type][r][t]}}function v(e){return{p:e.p.slice().reverse().map((e=>e.map((e=>-e)))),n:e.n.slice().reverse().map((e=>e.map((e=>-e)))),b:e.b.slice().reverse().map((e=>e.map((e=>-e)))),r:e.r.slice().reverse().map((e=>e.map((e=>-e)))),q:e.q.slice().reverse().map((e=>e.map((e=>-e)))),k:e.k.slice().reverse().map((e=>e.map((e=>-e))))}}const g={p:[[0,0,0,0,0,0,0,0],[50,50,50,50,50,50,50,50],[10,10,20,30,30,20,10,10],[5,5,10,25,25,10,5,5],[0,0,0,20,20,0,0,0],[5,-5,-10,0,0,-10,-5,5],[5,10,10,-20,-20,10,10,5],[0,0,0,0,0,0,0,0]],n:[[-50,-40,-30,-30,-30,-30,-40,-50],[-40,-20,0,0,0,0,-20,-40],[-30,0,10,15,15,10,0,-30],[-30,5,15,20,20,15,5,-30],[-30,0,15,20,20,15,0,-30],[-30,5,10,15,15,10,5,-30],[-40,-20,0,5,5,0,-20,-40],[-50,-40,-30,-30,-30,-30,-40,-50]],b:[[-20,-10,-10,-10,-10,-10,-10,-20],[-10,0,0,0,0,0,0,-10],[-10,0,5,10,10,5,0,-10],[-10,5,5,10,10,5,5,-10],[-10,0,10,10,10,10,0,-10],[-10,10,10,10,10,10,10,-10],[-10,5,0,0,0,0,5,-10],[-20,-10,-10,-10,-10,-10,-10,-20]],r:[[0,0,0,0,0,0,0,0],[5,10,10,10,10,10,10,5],[-5,0,0,0,0,0,0,-5],[-5,0,0,0,0,0,0,-5],[-5,0,0,0,0,0,0,-5],[-5,0,0,0,0,0,0,-5],[-5,0,0,0,0,0,0,-5],[0,0,0,5,5,0,0,0]],q:[[-20,-10,-10,-5,-5,-10,-10,-20],[-10,0,0,0,0,0,0,-10],[-10,0,5,5,5,5,0,-10],[-5,0,5,5,5,5,0,-5],[0,0,5,5,5,5,0,-5],[-10,5,5,5,5,5,0,-10],[-10,0,5,0,0,0,0,-10],[-20,-10,-10,-5,-5,-10,-10,-20]],k:[[-30,-40,-40,-50,-50,-40,-40,-30],[-30,-40,-40,-50,-50,-40,-40,-30],[-30,-40,-40,-50,-50,-40,-40,-30],[-30,-40,-40,-50,-50,-40,-40,-30],[-20,-30,-30,-40,-40,-30,-30,-20],[-10,-20,-20,-20,-20,-20,-20,-10],[20,20,0,0,0,0,20,20],[20,30,10,0,0,10,30,20]]},h=g,b={p:[[0,0,0,0,0,0,0,0],[50,50,50,50,50,50,50,50],[30,30,30,30,30,30,30,30],[25,25,25,25,25,25,25,25],[10,10,10,10,10,10,10,10],[5,5,5,5,5,5,5,5],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],n:[[-50,-40,-30,-30,-30,-30,-40,-50],[-40,-20,5,5,5,5,-20,-40],[-30,5,10,15,15,10,5,-30],[-30,5,15,20,20,15,5,-30],[-30,5,15,20,20,15,5,-30],[-30,5,10,15,15,10,5,-30],[-40,-20,5,5,5,5,-20,-40],[-50,-40,-30,-30,-30,-30,-40,-50]],b:[[-20,-10,-10,-10,-10,-10,-10,-20],[-10,0,5,5,5,5,0,-10],[-10,5,10,10,10,10,5,-10],[-10,5,10,10,10,10,5,-10],[-10,5,10,10,10,10,5,-10],[-10,5,10,10,10,10,5,-10],[-10,0,5,5,5,5,0,-10],[-20,-10,-10,-10,-10,-10,-10,-20]],r:[[-5,-5,-5,-5,-5,-5,-5,-5],[-5,0,0,0,0,0,0,-5],[-5,0,0,0,0,0,0,-5],[-5,0,0,0,0,0,0,-5],[-5,0,0,0,0,0,0,-5],[-5,0,0,0,0,0,0,-5],[-5,0,0,0,0,0,0,-5],[-5,-5,-5,-5,-5,-5,-5,-5]],q:[[-20,-10,-10,-5,-5,-10,-10,-20],[-10,0,5,5,5,5,0,-10],[-10,5,5,5,5,5,5,-10],[-5,5,5,5,5,5,5,-5],[-5,5,5,5,5,5,5,-5],[-10,5,5,5,5,5,5,-10],[-10,0,5,5,5,5,0,-10],[-20,-10,-10,-5,-5,-10,-10,-20]],k:[[0,0,0,0,0,0,0,0],[8,8,10,11,11,10,8,8],[6,6,7,9,9,7,6,6],[4,4,5,7,7,5,4,4],[2,2,3,5,5,3,2,2],[0,2,2,3,3,2,2,0],[-5,-2,-2,0,0,-2,-2,-5],[-5,-5,-5,-5,-5,-5,-5,-5]]},w={w:g,b:v(g)},k={w:h,b:v(h)},y={w:b,b:v(b)};var O;!function(e){e[e.init=0]="init",e[e.params=1]="params",e[e.pending=2]="pending",e[e.result=3]="result"}(O||(O={}));let j=new i.d$,M=-1,x=3;self.onmessage=e=>{let r=e.data;switch(r.type){case O.init:return M=r.id,void(x=r.searchDepth??3);case O.params:if(M!==r.id)return;if(void 0!==r.fen){j.load(r.fen,{skipValidation:!0});let e=u(j,x);self.postMessage({type:O.result,id:M,move:e})}else if(void 0!==r.pgn){let e=new i.d$;e.loadPgn(r.pgn);let t=u(e,x,{testTFR:!0});self.postMessage({type:O.result,id:M,move:t})}return;default:throw new Error("Invalid message type")}}}},n={};function i(e){var r=n[e];if(void 0!==r)return r.exports;var o=n[e]={exports:{}};return t[e](o,o.exports,i),o.exports}i.m=t,i.x=()=>{var e=i.O(void 0,[169],(()=>i(668)));return e=i.O(e)},e=[],i.O=(r,t,n,o)=>{if(!t){var s=1/0;for(u=0;u<e.length;u++){for(var[t,n,o]=e[u],l=!0,a=0;a<t.length;a++)(!1&o||s>=o)&&Object.keys(i.O).every((e=>i.O[e](t[a])))?t.splice(a--,1):(l=!1,o<s&&(s=o));if(l){e.splice(u--,1);var c=n();void 0!==c&&(r=c)}}return r}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[t,n,o]},i.d=(e,r)=>{for(var t in r)i.o(r,t)&&!i.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((r,t)=>(i.f[t](e,r),r)),[])),i.u=e=>"static/js/2669a500f07f1994240e.js",i.miniCssF=e=>{},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var r=i.g.document;if(!e&&r&&(r.currentScript&&(e=r.currentScript.src),!e)){var t=r.getElementsByTagName("script");if(t.length)for(var n=t.length-1;n>-1&&(!e||!/^http(s?):/.test(e));)e=t[n--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e+"../../"})(),(()=>{var e={668:1};i.f.i=(r,t)=>{e[r]||importScripts(i.p+i.u(r))};var r=self.webpackChunkstart=self.webpackChunkstart||[],t=r.push.bind(r);r.push=r=>{var[n,o,s]=r;for(var l in o)i.o(o,l)&&(i.m[l]=o[l]);for(s&&s(i);n.length;)e[n.pop()]=1;t(r)}})(),r=i.x,i.x=()=>i.e(169).then(r);i.x()})();